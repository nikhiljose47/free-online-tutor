<nav class="topbar px-3">
  <div class="topbar-inner">
    <a class="brand-area" routerLink="/" style="text-decoration: none">
      <img src="favicon.ico" class="app-logo" alt="logo" />
      <span class="brand-text">FreeTutor</span>
    </a>

    <div class="search-area d-none d-md-flex position-relative" style="overflow: visible">
      <input
        type="text"
        class="search-input"
        placeholder="Search classes, topics, exams..."
        (input)="ss.query.set($any($event.target).value)"
      />

      <button class="search-btn">
        <i class="bi bi-search"></i>
      </button>

      <!-- Suggestion List -->
      <ul
        class="list-group position-absolute w-100 mt-2"
        *ngIf="ss.results().length > 0"
        style="z-index: 103; top: 100%; left: 0"
      >
        <li
          class="list-group-item list-group-item-action"
          *ngFor="let item of ss.results()"
          (mousedown)="ss.navigate(item.route)"
          style="background: #111; color: #fff"
        >
          {{ item.label }}
        </li>
      </ul>
    </div>

    <!-- RIGHT -->
    <div class="actions">
      <!-- BEFORE LOGIN -->
      <ng-container *ngIf="!profile()">
        <button class="login-btn" routerLink="/login">Log In</button>
        <button class="signup-btn" routerLink="/register">Sign Up</button>
      </ng-container>

      <!-- AFTER LOGIN -->
      <ng-container *ngIf="profile()">
        <a
          *ngIf="profile()?.role === 'teacher'"
          class="topbar-link"
          routerLink="/schedule"
          routerLinkActive="active"
        >
          Schedule a Class
        </a>
        <a class="topbar-link" routerLink="/teachers" routerLinkActive="active">Teachers</a>
        <a class="topbar-link" routerLink="/hopin" routerLinkActive="active">Hop-in</a>
        <a class="topbar-link" routerLink="/report-card" routerLinkActive="active">Report Card</a>

        <div class="profile-container">
          <div class="profile-wrapper" (click)="toggleMenu()">
            <i class="bi bi-person-circle profile-icon"></i>
          </div>

          <div class="profile-menu" *ngIf="menuOpen()">
            <a routerLink="/profile" class="menu-item" (click)="closeMenu()">My Profile</a>
            <a routerLink="/about" class="menu-item" (click)="closeMenu()">About</a>

            <button
              class="menu-item btn btn-outline-dark"
              (click)="logout(); closeMenu(); $event.stopPropagation()"
            >
              Logout
            </button>
          </div>
        </div>
        <!-- CLICK OUTSIDE OVERLAY (Closes menu) -->
        <div *ngIf="menuOpen()" class="menu-overlay" (click)="closeMenu()"></div>
      </ng-container>
    </div>
  </div>
</nav>
