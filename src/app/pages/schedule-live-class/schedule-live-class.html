<div class="container mt-4">
  <section *ngIf="profile() as teacher">
    <h3 class="fw-bold">Welcome, {{ teacher.name }} teacher</h3>
  </section>
  <h3 class="title">Schedule a Live Class</h3>

  <div class="card p-3 shadow-sm border-0 mb-4">
    <div class="row g-3">
      <!-- CLASS -->
      <div class="col-md-4">
        <label class="form-label">Class</label>
        <select
          class="form-select"
          [value]="classId()"
          (change)="classId.set($any($event.target).value); subjectId.set(''); chapterCode.set('')"
        >
          <option value="">Select Class</option>
          <option *ngFor="let c of classList()" [value]="c">{{ c }}</option>
        </select>
      </div>

      <!-- SUBJECT -->
      <div class="col-md-4">
        <label class="form-label">Subject</label>
        <select
          class="form-select"
          [value]="subjectId()"
          [disabled]="!subjectList().length"
          (change)="subjectId.set($any($event.target).value); chapterCode.set('')"
        >
          <option value="">Select Subject</option>
          <option *ngFor="let s of subjectList()" [value]="s">{{ s }}</option>
        </select>
      </div>

      <!-- CHAPTER -->
      <div class="col-md-4">
        <label class="form-label">Chapter</label>
        <select
          class="form-select"
          [value]="chapterCode()"
          [disabled]="!chapterList().length"
          (change)="chapterCode.set($any($event.target).value)"
        >
          <option value="">Select Chapter</option>
          <option *ngFor="let ch of chapterList()" [value]="ch.code">
            {{ ch.code }} â€” {{ ch.name }}
          </option>
        </select>
      </div>

      <!-- BATCH -->
      <div class="col-md-6">
        <label class="form-label">Batch ID</label>
        <input
          class="form-control"
          [value]="batchId()"
          (input)="batchId.set($any($event.target).value)"
        />
      </div>

      <!-- MEETING LINK -->
      <input
        class="form-control"
        [ngClass]="{ 'is-invalid': !isMeetLinkValid() }"
        [value]="meetLink()"
        (input)="onMeetLinkInput($event)"
      />

      <div class="invalid-feedback" *ngIf="!isMeetLinkValid()">Invalid meeting link.</div>
      <!-- DATE/TIME -->
      <div class="col-md-12">
        <label class="form-label">Class Date & Time</label>
        <input
          type="datetime-local"
          class="form-control"
          [value]="date()"
          (input)="date.set($any($event.target).value)"
        />
      </div>

      <!-- BUTTON -->
      <div class="col-12 text-end">
        <button class="btn btn-primary px-4" [disabled]="submitting()" (click)="scheduleClass()">
          Schedule Class
        </button>
      </div>
    </div>
  </div>

  <!-- END CLASS SECTION -->
  <div class="card p-3 shadow-sm border-0" *ngIf="meetingId()">
    <h5>End Live Class</h5>

    <p class="text-muted small">Meeting ID: {{ meetingId() }}</p>

    <button class="btn btn-danger" (click)="endClass()">End Class & Mark Attendance</button>
  </div>
</div>
